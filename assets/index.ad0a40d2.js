import{P as Z,O as g,V as d,Q as S,a as T,T as k,M as f,b as p,c as K,d as P,F as J,G as ee,W as te,e as oe,E as ae,S as ne,f as se,g as ie,R as re,h as ce,U as de,i as X,j as le,k as R,l as me,B as he,C as pe,m as ue,n as we,H as Y,o as ge,D as fe,A as ye,p as Se,q as Pe,r as ve}from"./vendor.95e0301d.js";const Me=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const r of i.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&s(r)}).observe(document,{childList:!0,subtree:!0});function o(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerpolicy&&(i.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?i.credentials="include":n.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(n){if(n.ep)return;n.ep=!0;const i=o(n);fetch(n.href,i)}};Me();class Ee{camera;model;motion;velocity;position;acceleration;decceleration;animationState;location;lookSpeedX;lookSpeedY;constructor({FOV:e,aspect:o,near:s,far:n},i){this.camera=new Z(e,o,s,n),this.camera.name="PlayerCam",this.model=new g,this.model.add(this.camera);const r=new g;r.name="PlayerMesh",r.position.y+=.5,this.model.add(r),this.position=new d(0,0,0),this.motion={forward:!1,left:!1,reverse:!1,right:!1,speed:!1,mouseNormalX:0,mouseNormalY:0,mousecapture:!1},this.velocity=0,this.animationState="idle",this.location=i,this.initControls(),this.lookSpeedX=this.lookSpeedY=.05,this.acceleration=2,this.decceleration=new d}setCameraPosition(e){this.camera.position.copy(e)}addModel(e){this.model.getObjectByName("PlayerMesh")?.add(e)}initControls(){document.addEventListener("keydown",e=>{switch(e.key){case"w":case"W":this.motion.forward=!0,this.animationState="accelerating";break;case"a":case"A":this.motion.left=!0;break;case"s":case"S":this.motion.reverse=!0,this.animationState="decelerating";break;case"d":case"D":this.motion.right=!0;break;case"Shift":this.motion.speed=!0;break}}),document.addEventListener("keypress",e=>{switch(e.key){case"c":this.motion.mousecapture=!this.motion.mousecapture,this.motion.mouseNormalX=0,this.motion.mouseNormalY=0}}),document.addEventListener("keyup",e=>{switch(e.key){case"w":case"W":this.motion.forward=!1,this.animationState="idle";break;case"a":case"A":this.motion.left=!1;break;case"s":case"S":this.motion.reverse=!1,this.animationState="idle";break;case"d":case"D":this.motion.right=!1;break;case"Shift":this.motion.speed=!1}}),document.addEventListener("pointermove",e=>{if(this.motion.mousecapture){const o=e.clientX/window.innerWidth*2-1,s=-(e.clientY/window.innerHeight)*2+1;console.log({normalisedX:o,normalisedY:s}),this.motion.mouseNormalX=-o,this.motion.mouseNormalY=s}}),document.addEventListener("touchstart",e=>{this.lookSpeedX=this.lookSpeedY=3e-5}),document.addEventListener("mousedown",()=>{this.motion.mousecapture=!0}),document.addEventListener("mouseup",()=>{this.motion.mousecapture=!1,this.motion.mouseNormalX=0,this.motion.mouseNormalY=0})}motionUpdate(e){let o=this.acceleration;this.motion.speed&&(o*=2),this.motion.forward&&(this.velocity+=o*e),this.motion.left&&this.model.rotateY(2*e),this.motion.right&&this.model.rotateY(-2*e),this.motion.reverse&&(this.velocity-=o*e);let s=new S,n=new S;s.setFromAxisAngle(new d(0,1,0),this.motion.mouseNormalX*this.lookSpeedX),n.setFromAxisAngle(new d(1,0,0),this.motion.mouseNormalY*.3),this.model.applyQuaternion(s),this.camera.quaternion.slerp(n,.05)}animate(){const e=this.model.getObjectByName("PlayerMesh");switch(this.animationState){case"accelerating":{const o=new S;o.setFromAxisAngle(new d(1,0,0),-Math.PI/6),e.quaternion.slerp(o,.1);break}case"decelerating":{const o=new S;o.setFromAxisAngle(new d(1,0,0),Math.PI/6),e.quaternion.slerp(o,.1);break}case"idle":{const o=new S;o.setFromAxisAngle(new d(1,0,0),0),e.quaternion.slerp(o,.1);break}}}update(e){this.motionUpdate(e),this.animate(),this.model.translateZ(-this.velocity),this.velocity*=.8}}const Te=new T(1,1,1,1),_e=new k(.5,.05,72,36),be=new f({color:"gold"});class Le{_model;_interactionRing;_firmname;_message;constructor(e,o,s,n,i){this._firmname=e,this._message=o,this._model=new g,this.addBanner(s,i),this.addPanel(n);const r=new p(_e,be);r.rotateX(-Math.PI/2),r.position.set(1.375,.5,2),this._interactionRing=r,this._model.add(r)}update(){}async addPanel(e){this._model.add(e.clone())}addBanner(e,o){const s=new p(Te,new f({map:e,transparent:!0}));s.name=this._firmname,o&&s.position.copy(o),this._model.add(s)}}const xe=new T(4,2,1,1),Ae=new k(.5,.05,12,12),ke=new f({color:"gold"});class Re{_model;_interactionRing;_firmname;_message;constructor(e,o,s,n,i){this._firmname=e,this._message=o,this._model=new g,this.addBanner(s,i),this.addPanel(n);const r=new p(Ae,ke);r.rotateX(-Math.PI/2),r.position.set(3,.5,2),this._interactionRing=r,this._model.add(r)}update(){}async addPanel(e){this._model.add(e.clone())}addBanner(e,o){const s=new p(xe,new f({map:e}));o&&s.position.copy(o),this._model.add(s)}}const Ne="res/textures/grass/Grass_01.png",Ce="res/textures/grass/Grass_01_Nrm.png",Be="res/models/avatar/source/eve.fbx",Ie=document.querySelector("#app"),m={time:document.querySelector("#time"),location:document.querySelector("#location"),modal:{container:document.querySelector("#modal"),content:document.querySelector("#modal-content"),closeButtom:document.querySelector("#modal-close-button")},controls:{w:document.querySelector("#w"),a:document.querySelector("#a"),s:document.querySelector("#s"),d:document.querySelector("#d")}},N=new X,h=new K,v=h.load(Ne);v.wrapS=P;v.wrapT=P;v.repeat.set(64,64);v.repeat.set(64,64);const _=h.load(Ce);_.wrapS=P;_.wrapT=P;_.repeat.set(64,64);const W=new J,C=new ee,u=new te({logarithmicDepthBuffer:!0});u.shadowMap.enabled=!0;u.shadowMap.type=oe;u.physicallyCorrectLights=!0;u.setSize(window.innerWidth,window.innerHeight);u.setPixelRatio(window.devicePixelRatio);u.sortObjects=!0;Ie.appendChild(u.domElement);const b=new ae(u),a=new Ee({FOV:60,aspect:window.innerWidth/window.innerHeight,near:.1,far:1e3},"Forest");a.camera.position.set(0,1,0);["mousedown","touchstart"].forEach(t=>{m.controls.w.addEventListener(t,e=>{a.motion.forward=!0,a.animationState="accelerating"}),m.controls.a.addEventListener(t,e=>{a.motion.left=!0}),m.controls.s.addEventListener(t,e=>{a.motion.reverse=!0,a.animationState="decelerating"}),m.controls.d.addEventListener(t,e=>{a.motion.right=!0})});["mouseup","touchend"].forEach(t=>{m.controls.w.addEventListener(t,e=>{a.motion.forward=!1,a.animationState="idle"}),m.controls.a.addEventListener(t,e=>{a.motion.left=!1}),m.controls.s.addEventListener(t,e=>{a.motion.reverse=!1,a.animationState="idle"}),m.controls.d.addEventListener(t,e=>{a.motion.right=!1})});const M=new ve,l=new ne;l.add(a.model);l.fog=new se(12632256,.04);a.model.castShadow=!1;const j=new ie(65793,1);a.addModel(j);j.position.set(0,0,0);a.setCameraPosition(new d(0,1.25,2));const c={PlayerState:"FREEROAM",interationTargetPosition:new d(0,0,0)};m.modal.closeButtom.addEventListener("click",t=>{m.modal.container.classList.remove("appear-grow"),c.PlayerState="INTERESTED"});W.load(Be,t=>{t.rotateY(Math.PI),t.scale.set(.1,.1,.1),t.traverse(e=>{e instanceof p&&(e.material.metalness=1,e.material.roughness=0)}),a.addModel(t)});const q=new re(void 0,void 0,void 0,5),Fe=new ce(l,a.camera);b.addPass(Fe);const Ge=new de(new X(window.innerWidth,window.innerHeight),1,.5,.98);b.addPass(Ge);if(window.devicePixelRatio<=1){const t=new le(window.innerWidth,window.innerHeight);b.addPass(t)}const O=new p(new T(200,200,100,100),new R({map:v,normalMap:_}));O.rotateX(-Math.PI/2);l.add(O);const D=new p(new me(100,40,40),new f({color:8900331,fog:!0,side:he}));D.name="skyball";l.add(D);function Xe(){const t=new ye(4210752,4);l.add(t);const e=new Se(16777215,8);e.color.setHSL(.5,.3,.2),e.position.set(0,1.75,0),e.position.multiplyScalar(40),l.add(e);const o=new Pe(16777215,16777215,2);o.color.setHSL(.3,.5,.8),o.groundColor.setHSL(.6,.3,.4),l.add(o)}Xe();const Ye="res/logos/",We=[{path:"cu-logo.png",firm:"Crypto University",message:"Crypto University"},{path:"dharampeth-logo.png",firm:"Dharampeth Mahila Bank",message:"Dharampeth Mahila Bank"},{path:"empower-logo.png",firm:"empower",message:"empower"},{path:"made-easy-logo.png",firm:"made-easy",message:"made-easy"},{path:"nest-and-spoon-logo.png",firm:"nest and spoon",message:"nest and spoon"},{path:"wcl-logo.png",firm:"WCL",message:"WCL"}];let B=[],H=-15;const U=await C.loadAsync("res/models/misc/Spons Panel.glb");U.scene.scale.setScalar(.001);for(let t of We){const e=await h.loadAsync(`${Ye}${t.path}`),o=new Le(t.firm,t.message,e,U.scene,new d(1.375,1.375,.01));B.push(o),l.add(o._model),o._model.rotateY(-Math.PI/2),o._model.position.set(10,0,H),H+=5}let I=[];const $=await W.loadAsync("res/models/misc/Display Panels.fbx");$.scale.setScalar(.001);const je=await h.loadAsync("res/backgrounds/vnit_pan_2.png"),y=new Re("My Artwork","My Canvas",je,$,new d(3.1875,1.5,-1));I.push(y);l.add(y._model);y._model.position.set(-10,0,0);y._model.lookAt(a.position);const L=await h.loadAsync("res/textures/hedge/base.jpg");L.wrapS=L.wrapT=P;L.repeat.set(200,5);const qe=await h.loadAsync("res/textures/hedge/normal.jpg"),Oe=await h.loadAsync("res/textures/hedge/height.png"),De=await h.loadAsync("res/textures/hedge/ao.jpg"),He=await h.loadAsync("res/textures/hedge/roughness.jpg"),V=new p(new k(50,1,30,120),new R({map:L,normalMap:qe,bumpMap:Oe,aoMap:De,roughness:1,roughnessMap:He}));V.rotateX(-Math.PI/2);l.add(V);const Ue=await h.loadAsync("res/textures/concrete/base.jpg"),$e=await h.loadAsync("res/textures/concrete/normal.jpg"),Ve=await h.loadAsync("res/textures/concrete/height.png"),Qe=await h.loadAsync("res/textures/concrete/ao.jpg"),ze=await h.loadAsync("res/textures/concrete/roughness.jpg"),F=await C.loadAsync("res/models/misc/Hobo.glb");F.scene.traverse(t=>{t instanceof p&&(t.geometry.computeVertexNormals(),t.material.metalness=1,t.material.color=new pe(15787510))});F.scene.scale.setScalar(.001);const Ze=new ue(3,3,.3,36,1),Q=new R({map:Ue,normalMap:$e,bumpMap:Ve,aoMap:Qe,roughness:.5,roughnessMap:ze}),Ke=new p(Ze,Q),E=new g;E.add(Ke);E.add(F.scene);l.add(E);E.position.set(0,0,-20);const Je=await C.loadAsync("res/models/misc/Dome 2.glb"),G=Je.scene;G.scale.setScalar(1.5);G.position.y-=.5;l.add(G);const x=new g,et=Q,tt=new p(new we(8,.3,4),et);x.add(tt);const w=document.createElement("video");let ot="https://cph-msl.akamaized.net/hls/live/2000341/test/master.m3u8";if(Y.isSupported()){let t=new Y;t.loadSource(ot),t.attachMedia(w)}document.addEventListener("load",t=>{w.play()});const at=new T(6,3),nt=new ge(w),A=new p(at,new f({color:16448250,map:nt,side:fe}));A.translateY(1.5);A.rotateY(-Math.PI);A.name="showcase-screen";x.add(A);l.add(x);x.position.set(0,0,15);document.addEventListener("click",t=>{N.x=t.clientX/window.innerWidth*2-1,N.y=-(t.clientY/window.innerHeight)*2+1,q.setFromCamera(N,a.camera);const e=q.intersectObjects(l.children,!0);console.log(e),e[0].object.name=="showcase-screen"&&(w.paused||w.currentTime==0?w.play():w.pause())});function st(){E.rotateY(.02),B.forEach(t=>{t._interactionRing.rotation.x=-Math.PI/2+.25*Math.cos(M.getElapsedTime()*2),t._interactionRing.rotation.y=.25*Math.sin(M.getElapsedTime()*2)}),I.forEach(t=>{t._interactionRing.rotation.x=-Math.PI/2+.25*Math.cos(M.getElapsedTime()*2),t._interactionRing.rotation.y=.25*Math.sin(M.getElapsedTime()*2)}),c.PlayerState=="FREEROAM"&&I.forEach(t=>{let e=new d;t._interactionRing.getWorldPosition(e),e.projectOnPlane(new d(0,1,0)).distanceTo(a.model.position)<.6&&(c.PlayerState="INTERACTING",c.interationTargetPosition.copy(e),a.motion.mousecapture=!1,a.motion.mouseNormalX=a.motion.mouseNormalY=0,m.modal.container.classList.add("appear-grow"),m.modal.content.innerText=`Artwork: ${y._firmname}, By: ${y._message}`)}),c.PlayerState=="INTERESTED"&&(console.log(a.model.position.distanceTo(c.interationTargetPosition)),a.model.position.distanceTo(c.interationTargetPosition)>1&&(c.PlayerState="FREEROAM")),c.PlayerState=="FREEROAM"&&B.forEach(t=>{let e=new d;t._interactionRing.getWorldPosition(e),e.projectOnPlane(new d(0,1,0)).distanceTo(a.model.position)<.2&&(c.PlayerState="INTERACTING",a.animationState="idle",c.interationTargetPosition.copy(e),a.motion.mousecapture=!1,a.motion.mouseNormalX=a.motion.mouseNormalY=0,m.modal.container.classList.add("appear-grow"),m.modal.content.innerText=`Welcome to Aarohi'22 sponsored by: ${t._firmname}, they say: ${t._message}`)}),c.PlayerState=="INTERESTED"&&(console.log(a.model.position.distanceTo(c.interationTargetPosition)),a.model.position.distanceTo(c.interationTargetPosition)>1&&(c.PlayerState="FREEROAM"))}function it(){c.PlayerState!="INTERACTING"&&a.update(M.getDelta()),st()}function z(){b.render(),it(),window.requestAnimationFrame(z)}window.addEventListener("resize",()=>{u.setSize(window.innerWidth,window.innerHeight),a.camera.aspect=window.innerWidth/window.innerHeight,a.camera.updateProjectionMatrix()});z();
